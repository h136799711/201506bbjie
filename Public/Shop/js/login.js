define(["jquery","jquery.validate"],function(e){return{run:function(t){function n(t,r,i){t.each(function(){r>0?(e(this).html(r),setTimeout(function(){n(t,r-1,i)},1e3)):i&&i(!0)})}e("#password").keyup(function(t){var n=new RegExp("^(?=.{9,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*\\W).*$","g"),r=new RegExp("^(?=.{7,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$","g"),i=new RegExp("(?=.{1,}).*","g");return 0!=i.test(e(this).val())&&(n.test(e(this).val())?(e(".l01 span").addClass("current"),e(".l02 span").addClass("current"),e(".l03 span").addClass("current")):r.test(e(this).val())?(e(".l01 span").addClass("current"),e(".l02 span").addClass("current"),e(".l03 span").removeClass("current")):(e(".l01 span").addClass("current"),e(".l02 span").removeClass("current"),e(".l03 span").removeClass("current"))),!0}),e(".send_code").live("click",function(){var t=e.trim(e("#phone_tel").val()),r=e(this).attr("url");if(t==null||t=="")return alert("请输入您的手机号码"),!1;var i=/^(1[0-9]{10})$/;if(!i.test(t))return alert("请输入正确格式的手机号码"),!1;var s={};s.phone=t,e.ajax({url:r,data:s,type:"post",dataType:"json",success:function(t){t.status==0&&alert(t.info),t.status==1&&(alert("手机验证码发送成功,请注意查收","手机验证"),n(e("#daoji_number"),120,function(){e(".send_code").show(),e("#daojishi").hide()}),e(".send_code").hide(),e("#daojishi").show())}})}),t.find("form").once(function(){var t=e(this);t.validate({submitHandler:function(t){e(t).ajaxSubmit({dataType:"json",success:function(e){e.status==1?(alert("注册成功"),location.replace("/person")):e.status==3?location.replace(e.return):alert(e.info)}})},highlight:function(t,n,r){t.type==="radio"?this.findByName(t.name).addClass(n).removeClass(r):e(t).addClass(n).removeClass(r)},unhighlight:function(t,n,r){t.type==="radio"?this.findByName(t.name).removeClass(n).addClass(r):e(t).removeClass(n).addClass(r)},errorPlacement:function(e,t){var n=t.parents("div.controls").find("span.notice");n.append(e)},onkeyup:!1,rules:{user_name:{required:!0,byteRange:[6,16,"gbk"],remote:{url:"/index.php?app=member&act=check_user&ajax=1",type:"get",data:{user_name:function(){return e("#user_name").val()}},beforeSend:function(){var t=e("#checking_user");t.prev(".field_notice").hide(),t.next("label").hide(),e(t).show()},complete:function(){e("#checking_user").hide()}}},password:{required:!0},confirm_password:{required:!0,equalTo:"#password"},phone_tel:{required:!0,mobile:!0},code:{required:!0},agree:{required:!0},store_name:{required:!0},ali_wang:{required:!0,remote:{url:"/index.php?app=member&act=check_wangwang&ajax=1",type:"get"}},owner_name:{required:!0},im_qq:{required:!0}},messages:{user_name:{required:"请输入您要注册的用户名",byteRange:"用户名在6-16个字符之间",remote:"用户名已存在"},password:{required:"请输入您的密码"},confirm_password:{required:"请输入确认密码",equalTo:"确认密码与密码不符"},phone_tel:{required:"请输入手机号码",mobile:"请输入正确的手机号码"},code:{required:"请输入验证码"},agree:{required:"请同意用户使用协议"},store_name:{required:"请填写您的店铺名称"},ali_wang:{required:"请填写店铺主旺旺",remote:"该旺旺已被注册"},owner_name:{required:"请填写联系人姓名"},im_qq:{required:"请填写联系QQ"}}})}),e.validator.addMethod("mobile",function(e,t){var n=e.length,r=/^1[34578]\d{9}$/,i=/(\d)\1{6}/;return this.optional(t)||n==11&&r.test(e)&&!i.test(e)},"请输入真实的手机号码"),e.validator.addMethod("byteRange",function(e,t,n){var r=e.length,i=n[2]=="utf-8"?3:2;for(var s=0;s<e.length;s++)e.charCodeAt(s)>127&&(r=r+i-1);return this.optional(t)||(n[0]==""||r>=n[0])&&(n[1]==""||r<=n[1])})}}});