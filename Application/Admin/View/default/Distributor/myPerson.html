<extend name="template/base_index" />


<block name="area_header">

    <style type="text/css">
        input.error {
            border: 1px solid red;
        }

        label.checked {
            padding-left: 25px;
        }

        label.error {
            padding-left: 25px;
            padding-bottom: 2px;
            font-weight: bold;
            color: #EA5200;
        }
    </style>

</block>

<block name="area_body">
    {:W('Menus/topbar')}
    <div class="admin-main container-fluid">
        {:W('Menus/left')}
        <div class="admin-main-content">
            {:W('Menus/breadcrumb')}

            <div>

                <div>

                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active">
                            <a href="#seller" aria-controls="home" role="tab" data-toggle="tab">商家用户</a>
                        </li>
                        <li role="presentation">
                            <a href="#normal" aria-controls="profile" role="tab" data-toggle="tab">宝民用户</a>
                        </li>
                     </ul>

                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="seller">

                        </div>
                        <div role="tabpanel" class="tab-pane" id="normal">

                        </div>
                    </div>

                </div>


            </div>

            <!-- form -->

        </div>
        <!-- END admin-main-content -->
    </div>
    <!-- END admin-main-->
</block>

<block name="area_footer">

    <script type="text/javascript" src="__CDN__/react/15.1.0/react.js"></script>
    <script type="text/javascript" src="__CDN__/react/15.1.0/react-dom.js"></script>
    <script src="__CDN__/babel-core/5.8.24/browser.min.js"></script>
    <script src="__CDN__/bootstrap-react/0.29.4/react-bootstrap.min.js"></script>
    <script type="text/babel">

        var Alert = ReactBootstrap.Alert;
        var Table = ReactBootstrap.Table;

        var UserList = React.createClass({
            loadData:function(){
                var p = this.state.pager.pageIndex;
                var pageSize = this.state.pager.pageSize;
                var type = this.props.type;
                var params = "?type=" + type + "&p="+p+"&pagesize="+pageSize;

                $.ajax({
                  url: this.props.url + params,
                  dataType: 'json',
                  cache: false,
                  success: function(data) {
                    if(data.status){
                        var pager = data.info.pager;
                        this.setState({status:data.status,info:data.info,pager:pager});
                    }else{
                        this.setState({status:data.status,info:data.info,pager:{
                            total:0,
                            pageIndex:0,
                            pageSize:10}});
                    }
                  }.bind(this),
                  error: function(xhr, status, err) {
                    this.setState({status:false,info:'网络请求发生错误',totalCount: 0,pageSize:10,pageIndex:0});
                    console.log(err);
                  }.bind(this)
                });
            },
            getInitialState:function(){
                return {
                    status:false,
                    info:'loading...',
                    pager:{
                        total:0,
                        pageIndex:0,
                        pageSize:10
                    }
                };
            },

            componentDidMount:function(){
                //组件加载完成
                this.loadData();
            },
            render:function(){
                var status = this.state.status;
                var info = this.state.info;
                if(!status){
                    return (
                        <Alert bsStyle="warning">
                            <strong>{info}</strong>
                        </Alert>
                    );
                }


                var tbody = "<tr><td colspan='5'>没有相关数据</td></tr>";
                console.log(info);
                var list = info.list;
                var pager = info.pager;
                if(list && list.length > 0){
                    list.map(function(ele){
                        console.log(ele);

                    });
                }

                return (
                    <Table striped bordered condensed hover>
                        <thead>
                            <tr>
                            <th>用户ID</th>
                            <th>用户登录名</th>
                            <th>注册时间</th>
                            <th>最近登录时间</th>
                            <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>

                            {tbody}
                        </tbody>
                    </Table>

                );

            }


        });

        var url = "{:U('Admin/Distributor/myPerson')}";
        var url = "{:U('Admin/Distributor/myPerson')}";

        ReactDOM.render(<UserList url={url} type='seller'  />, document.getElementById("seller"));

        ReactDOM.render(<UserList url={url} type='normal'  />, document.getElementById("normal"));


    </script>



</block>